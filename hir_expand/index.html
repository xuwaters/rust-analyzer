<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="generator" content="rustdoc"><meta name="description" content="`hir_expand` deals with macro expansion."><title>hir_expand - Rust</title><script>if(window.location.protocol!=="file:")document.head.insertAdjacentHTML("beforeend","SourceSerif4-Regular-46f98efaafac5295.ttf.woff2,FiraSans-Regular-018c141bf0843ffd.woff2,FiraSans-Medium-8f9a781e4970d388.woff2,SourceCodePro-Regular-562dcc5011b6de7d.ttf.woff2,SourceCodePro-Semibold-d899c5a5c4aeb14a.ttf.woff2".split(",").map(f=>`<link rel="preload" as="font" type="font/woff2" crossorigin href="../static.files/${f}">`).join(""))</script><link rel="stylesheet" href="../static.files/normalize-76eba96aa4d2e634.css"><link rel="stylesheet" href="../static.files/rustdoc-492a78a4a87dcc01.css"><meta name="rustdoc-vars" data-root-path="../" data-static-root-path="../static.files/" data-current-crate="hir_expand" data-themes="" data-resource-suffix="" data-rustdoc-version="1.82.0 (f6e511eec 2024-10-15)" data-channel="1.82.0" data-search-js="search-a99f1315e7cc5121.js" data-settings-js="settings-4313503d2e1961c2.js" ><script src="../static.files/storage-118b08c4c78b968e.js"></script><script defer src="../crates.js"></script><script defer src="../static.files/main-921df33f47b8780c.js"></script><noscript><link rel="stylesheet" href="../static.files/noscript-3b12f09e550e0385.css"></noscript><link rel="alternate icon" type="image/png" href="../static.files/favicon-32x32-422f7d1d52889060.png"><link rel="icon" type="image/svg+xml" href="../static.files/favicon-2c020d218678b618.svg"></head><body class="rustdoc mod crate"><!--[if lte IE 11]><div class="warning">This old browser is unsupported and will most likely display funky things.</div><![endif]--><nav class="mobile-topbar"><button class="sidebar-menu-toggle" title="show sidebar"></button></nav><nav class="sidebar"><div class="sidebar-crate"><h2><a href="../hir_expand/index.html">hir_<wbr>expand</a><span class="version">0.0.0</span></h2></div><div class="sidebar-elems"><ul class="block"><li><a id="all-types" href="all.html">All Items</a></li></ul><section><ul class="block"><li><a href="#reexports">Re-exports</a></li><li><a href="#modules">Modules</a></li><li><a href="#macros">Macros</a></li><li><a href="#structs">Structs</a></li><li><a href="#enums">Enums</a></li><li><a href="#traits">Traits</a></li><li><a href="#functions">Functions</a></li><li><a href="#types">Type Aliases</a></li></ul></section></div></nav><div class="sidebar-resizer"></div><main><div class="width-limiter"><rustdoc-search></rustdoc-search><section id="main-content" class="content"><div class="main-heading"><h1>Crate <a class="mod" href="#">hir_expand</a><button id="copy-path" title="Copy item path to clipboard">Copy item path</button></h1><span class="out-of-band"><a class="src" href="../src/hir_expand/lib.rs.html#1-1026">source</a> · <button id="toggle-all-docs" title="collapse all docs">[<span>&#x2212;</span>]</button></span></div><details class="toggle top-doc" open><summary class="hideme"><span>Expand description</span></summary><div class="docblock"><p><code>hir_expand</code> deals with macro expansion.</p>
<p>Specifically, it implements a concept of <code>MacroFile</code> – a file whose syntax
tree originates not from the text of some <code>FileId</code>, but from some macro
expansion.</p>
</div></details><h2 id="reexports" class="section-header">Re-exports<a href="#reexports" class="anchor">§</a></h2><ul class="item-table"><li><div class="item-name" id="reexport.AstId"><code>pub use crate::files::<a class="type" href="files/type.AstId.html" title="type hir_expand::files::AstId">AstId</a>;</code></div></li><li><div class="item-name" id="reexport.ErasedAstId"><code>pub use crate::files::<a class="type" href="files/type.ErasedAstId.html" title="type hir_expand::files::ErasedAstId">ErasedAstId</a>;</code></div></li><li><div class="item-name" id="reexport.FileRange"><code>pub use crate::files::<a class="type" href="files/type.FileRange.html" title="type hir_expand::files::FileRange">FileRange</a>;</code></div></li><li><div class="item-name" id="reexport.InFile"><code>pub use crate::files::<a class="type" href="files/type.InFile.html" title="type hir_expand::files::InFile">InFile</a>;</code></div></li><li><div class="item-name" id="reexport.InMacroFile"><code>pub use crate::files::<a class="type" href="files/type.InMacroFile.html" title="type hir_expand::files::InMacroFile">InMacroFile</a>;</code></div></li><li><div class="item-name" id="reexport.InRealFile"><code>pub use crate::files::<a class="type" href="files/type.InRealFile.html" title="type hir_expand::files::InRealFile">InRealFile</a>;</code></div></li></ul><h2 id="modules" class="section-header">Modules<a href="#modules" class="anchor">§</a></h2><ul class="item-table"><li><div class="item-name"><a class="mod" href="attrs/index.html" title="mod hir_expand::attrs">attrs</a></div><div class="desc docblock-short">A higher level attributes based on TokenTree, with also some shortcuts.</div></li><li><div class="item-name"><a class="mod" href="builtin/index.html" title="mod hir_expand::builtin">builtin</a></div><div class="desc docblock-short">Builtin macros and attributes</div></li><li><div class="item-name"><a class="mod" href="change/index.html" title="mod hir_expand::change">change</a></div><div class="desc docblock-short">Defines a unit of change that can applied to the database to get the next
state. Changes are transactional.</div></li><li><div class="item-name"><a class="mod" href="db/index.html" title="mod hir_expand::db">db</a></div><div class="desc docblock-short">Defines database &amp; queries for macro expansion.</div></li><li><div class="item-name"><a class="mod" href="declarative/index.html" title="mod hir_expand::declarative">declarative</a></div><div class="desc docblock-short">Compiled declarative macro expanders (<code>macro_rules!</code> and <code>macro</code>)</div></li><li><div class="item-name"><a class="mod" href="eager/index.html" title="mod hir_expand::eager">eager</a></div><div class="desc docblock-short">Eager expansion related utils</div></li><li><div class="item-name"><a class="mod" href="files/index.html" title="mod hir_expand::files">files</a></div><div class="desc docblock-short">Things to wrap other things in file ids.</div></li><li><div class="item-name"><a class="mod" href="hygiene/index.html" title="mod hir_expand::hygiene">hygiene</a></div><div class="desc docblock-short">Machinery for hygienic macros.</div></li><li><div class="item-name"><a class="mod" href="inert_attr_macro/index.html" title="mod hir_expand::inert_attr_macro">inert_<wbr>attr_<wbr>macro</a></div><div class="desc docblock-short">Builtin attributes resolved by nameres.</div></li><li><div class="item-name"><a class="mod" href="mod_path/index.html" title="mod hir_expand::mod_path">mod_<wbr>path</a></div><div class="desc docblock-short">A lowering for <code>use</code>-paths (more generally, paths without angle-bracketed segments).</div></li><li><div class="item-name"><a class="mod" href="name/index.html" title="mod hir_expand::name">name</a></div><div class="desc docblock-short">See <a href="name/struct.Name.html" title="struct hir_expand::name::Name"><code>Name</code></a>.</div></li><li><div class="item-name"><a class="mod" href="proc_macro/index.html" title="mod hir_expand::proc_macro">proc_<wbr>macro</a></div><div class="desc docblock-short">Proc Macro Expander stuff</div></li><li><div class="item-name"><a class="mod" href="span_map/index.html" title="mod hir_expand::span_map">span_<wbr>map</a></div><div class="desc docblock-short">Span maps for real files and macro expansions.</div></li><li><div class="item-name"><a class="mod" href="tt/index.html" title="mod hir_expand::tt">tt</a></div></li></ul><h2 id="macros" class="section-header">Macros<a href="#macros" class="anchor">§</a></h2><ul class="item-table"><li><div class="item-name"><a class="macro" href="macro.__known_path.html" title="macro hir_expand::__known_path">__<wbr>known_<wbr>path</a></div></li><li><div class="item-name"><a class="macro" href="macro.__path.html" title="macro hir_expand::__path">__path</a></div></li><li><div class="item-name"><a class="macro" href="macro.impl_intern_lookup.html" title="macro hir_expand::impl_intern_lookup">impl_<wbr>intern_<wbr>lookup</a></div></li><li><div class="item-name"><a class="macro" href="macro.quote.html" title="macro hir_expand::quote">quote</a></div><div class="desc docblock-short">FIXME:
It probably should implement in proc-macro</div></li></ul><h2 id="structs" class="section-header">Structs<a href="#structs" class="anchor">§</a></h2><ul class="item-table"><li><div class="item-name"><a class="struct" href="struct.DeclarativeMacro.html" title="struct hir_expand::DeclarativeMacro">Declarative<wbr>Macro</a></div><div class="desc docblock-short">This struct contains AST for a single <code>macro_rules</code> definition. What might
be very confusing is that AST has almost exactly the same shape as
<code>tt::TokenTree</code>, but there’s a crucial difference: in macro rules, <code>$ident</code>
and <code>$()*</code> have special meaning (see <code>Var</code> and <code>Repeat</code> data structures)</div></li><li><div class="item-name"><a class="struct" href="struct.EagerCallInfo.html" title="struct hir_expand::EagerCallInfo">Eager<wbr>Call<wbr>Info</a></div></li><li><div class="item-name"><a class="struct" href="struct.ExpandError.html" title="struct hir_expand::ExpandError">Expand<wbr>Error</a></div></li><li><div class="item-name"><a class="struct" href="struct.ExpansionInfo.html" title="struct hir_expand::ExpansionInfo">Expansion<wbr>Info</a></div><div class="desc docblock-short">ExpansionInfo mainly describes how to map text range between src and expanded macro</div></li><li><div class="item-name"><a class="struct" href="struct.HirFileId.html" title="struct hir_expand::HirFileId">HirFile<wbr>Id</a></div><div class="desc docblock-short">Input to the analyzer is a set of files, where each file is identified by
<code>FileId</code> and contains source code. However, another source of source code in
Rust are macros: each macro can be thought of as producing a “temporary
file”. To assign an id to such a file, we use the id of the macro call that
produced the file. So, a <code>HirFileId</code> is either a <code>FileId</code> (source code
written by user), or a <code>MacroCallId</code> (source code produced by macro).</div></li><li><div class="item-name"><a class="struct" href="struct.MacroCallId.html" title="struct hir_expand::MacroCallId">Macro<wbr>Call<wbr>Id</a></div><div class="desc docblock-short"><code>MacroCallId</code> identifies a particular macro invocation, like
<code>println!("Hello, {}", world)</code>.</div></li><li><div class="item-name"><a class="struct" href="struct.MacroCallLoc.html" title="struct hir_expand::MacroCallLoc">Macro<wbr>Call<wbr>Loc</a></div></li><li><div class="item-name"><a class="struct" href="struct.MacroDefId.html" title="struct hir_expand::MacroDefId">Macro<wbr>DefId</a></div></li><li><div class="item-name"><a class="struct" href="struct.MacroFileId.html" title="struct hir_expand::MacroFileId">Macro<wbr>File<wbr>Id</a></div></li><li><div class="item-name"><a class="struct" href="struct.ValueResult.html" title="struct hir_expand::ValueResult">Value<wbr>Result</a></div></li></ul><h2 id="enums" class="section-header">Enums<a href="#enums" class="anchor">§</a></h2><ul class="item-table"><li><div class="item-name"><a class="enum" href="enum.ExpandErrorKind.html" title="enum hir_expand::ExpandErrorKind">Expand<wbr>Error<wbr>Kind</a></div></li><li><div class="item-name"><a class="enum" href="enum.ExpandTo.html" title="enum hir_expand::ExpandTo">Expand<wbr>To</a></div><div class="desc docblock-short">In Rust, macros expand token trees to token trees. When we want to turn a
token tree into an AST node, we need to figure out what kind of AST node we
want: something like <code>foo</code> can be a type, an expression, or a pattern.</div></li><li><div class="item-name"><a class="enum" href="enum.MacroCallKind.html" title="enum hir_expand::MacroCallKind">Macro<wbr>Call<wbr>Kind</a></div></li><li><div class="item-name"><a class="enum" href="enum.MacroDefKind.html" title="enum hir_expand::MacroDefKind">Macro<wbr>DefKind</a></div></li></ul><h2 id="traits" class="section-header">Traits<a href="#traits" class="anchor">§</a></h2><ul class="item-table"><li><div class="item-name"><a class="trait" href="trait.HirFileIdExt.html" title="trait hir_expand::HirFileIdExt">HirFile<wbr>IdExt</a></div></li><li><div class="item-name"><a class="trait" href="trait.Intern.html" title="trait hir_expand::Intern">Intern</a></div></li><li><div class="item-name"><a class="trait" href="trait.Lookup.html" title="trait hir_expand::Lookup">Lookup</a></div></li><li><div class="item-name"><a class="trait" href="trait.MacroFileIdExt.html" title="trait hir_expand::MacroFileIdExt">Macro<wbr>File<wbr>IdExt</a></div></li></ul><h2 id="functions" class="section-header">Functions<a href="#functions" class="anchor">§</a></h2><ul class="item-table"><li><div class="item-name"><a class="fn" href="fn.check_cfg_attr_value.html" title="fn hir_expand::check_cfg_attr_value">check_<wbr>cfg_<wbr>attr_<wbr>value</a></div></li><li><div class="item-name"><a class="fn" href="fn.map_node_range_up.html" title="fn hir_expand::map_node_range_up">map_<wbr>node_<wbr>range_<wbr>up</a></div><div class="desc docblock-short">Maps up the text range out of the expansion hierarchy back into the original file its from.</div></li><li><div class="item-name"><a class="fn" href="fn.map_node_range_up_aggregated.html" title="fn hir_expand::map_node_range_up_aggregated">map_<wbr>node_<wbr>range_<wbr>up_<wbr>aggregated</a></div><div class="desc docblock-short">Maps up the text range out of the expansion hierarchy back into the original file its from.
This version will aggregate the ranges of all spans with the same anchor and syntax context.</div></li><li><div class="item-name"><a class="fn" href="fn.map_node_range_up_rooted.html" title="fn hir_expand::map_node_range_up_rooted">map_<wbr>node_<wbr>range_<wbr>up_<wbr>rooted</a></div><div class="desc docblock-short">Maps up the text range out of the expansion hierarchy back into the original file its from only
considering the root spans contained.
Unlike <a href="fn.map_node_range_up.html" title="fn hir_expand::map_node_range_up"><code>map_node_range_up</code></a>, this will not return <code>None</code> if any anchors or syntax contexts differ.</div></li><li><div class="item-name"><a class="fn" href="fn.prettify_macro_expansion.html" title="fn hir_expand::prettify_macro_expansion">prettify_<wbr>macro_<wbr>expansion</a></div><div class="desc docblock-short">Inserts whitespace and replaces <code>$crate</code> in macro expansions.</div></li><li><div class="item-name"><a class="fn" href="fn.span_for_offset.html" title="fn hir_expand::span_for_offset">span_<wbr>for_<wbr>offset</a></div><div class="desc docblock-short">Looks up the span at the given offset.</div></li></ul><h2 id="types" class="section-header">Type Aliases<a href="#types" class="anchor">§</a></h2><ul class="item-table"><li><div class="item-name"><a class="type" href="type.ExpandResult.html" title="type hir_expand::ExpandResult">Expand<wbr>Result</a></div></li></ul></section></div></main></body></html>